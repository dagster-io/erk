[project]
name = "csadmin"
version = "0.1.0"
description = "Compass System Administration CLI"
authors = [
    {name = "Elementl", email = "info@elementl.com"}
]
requires-python = ">=3.13"
dependencies = [
    "click>=8.0.0",
    "pydantic>=2.0.0",
    "pyyaml>=6.0.0",
    "csbot",
    "pygit2>=1.0.0",
]

[project.scripts]
csadmin = "csadmin.cli:cli"

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
packages = ["src/csadmin"]

[dependency-groups]
dev = [
    "pytest>=8.4.1",
    "pytest-asyncio>=0.23.0",
    "pyright>=1.1.389",
]

[tool.ruff]
# Target Python 3.13+
target-version = "py313"
line-length = 100

[tool.ruff.lint]
# Enable rules that enforce modern Python idioms
select = [
    "E",      # pycodestyle errors
    "W",      # pycodestyle warnings
    "F",      # pyflakes
    "I",      # isort
    "UP",     # pyupgrade (enforces modern Python syntax)
    "FA",     # flake8-future-annotations
    "TCH",    # flake8-type-checking
]

# Force specific modern typing patterns
ignore = [
    # Disable E501 (line too long) - temporarily disabled to focus on other issues
    "E501",
    # Disable W291 (trailing whitespace) - temporarily disabled to focus on other issues
    "W291",
    # Disable W293 (blank line contains whitespace) - temporarily disabled to focus on other issues
    "W293",
]

# Enable specific pyupgrade rules for modern typing
fixable = ["ALL"]
unfixable = []

[tool.ruff.lint.pyupgrade]
# Force PEP 585 (built-in generics like list[str] instead of List[str])
# Force PEP 604 (X | Y instead of Union[X, Y])
keep-runtime-typing = false

[tool.ruff.lint.flake8-type-checking]
# Enforce that type-only imports are in TYPE_CHECKING blocks
runtime-evaluated-base-classes = ["pydantic.BaseModel"]
strict = true

[tool.ruff.format]
# Use double quotes
quote-style = "double"

# Keep trailing commas for better git diffs
skip-magic-trailing-comma = false